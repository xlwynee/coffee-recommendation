<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªÙˆØµÙŠØ© Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    .price-slider {
      margin: 20px 0;
    }
    .range-value {
      font-size: 14px;
      margin-top: 5px;
      color: #555;
    }
    input[type="range"] {
      width: 100%;
      appearance: none;
      -webkit-appearance: none; /* Remove default slider style for WebKit browsers */
      -moz-appearance: none;    /* Remove default slider style for Firefox */
      background: transparent;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      background: #f8b5c1;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 0 3px rgba(0,0,0,0.2);
    }
    input[type="range"]::-webkit-slider-runnable-track {
      height: 6px;
      background: #f8b5c1;
      border-radius: 3px;
    }
    input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      background: #f8b5c1;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 0 3px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 style="color:#d17b88; margin-bottom:20px;">â˜• ØªÙˆØµÙŠØ© Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</h1>

    <h2>Ù…Ø§ Ù‡ÙŠ Ø¥ÙŠØ­Ø§Ø¡Ø§ØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©ØŸ</h2>
    <form method="post">
      <input type="text" name="preferences" placeholder="Ù…Ø«Ø§Ù„: ÙÙˆØ§ÙƒÙ‡ØŒ Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©ØŒ ÙƒØ±Ø§Ù…ÙŠÙ„" value="{{ request.form.get('preferences','') }}">

      <!-- Single slider for max price -->
      <div class="price-slider">
        <label>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© (Ø±ÙŠØ§Ù„)</label>
        <input type="range" id="maxPrice" name="max_price" min="0" max="200" step="5" value="{{ request.form.get('max_price','120') }}">
        <div class="range-value">
          <span id="maxPriceValue">{{ request.form.get('max_price','120') }} Ø±ÙŠØ§Ù„</span>
        </div>
      </div>

      <button type="submit">ğŸ” Ø§Ø¨Ø­Ø«</button>
    </form>

    {% if recommendations %}
      <h3>ğŸ¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</h3>
      {% for item in recommendations %}
        <div class="card">
          <strong>{{ item["Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"] }}</strong>
          <br>Ù…Ù† <strong>{{ item["Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ù…ØµØ©"] }}</strong> ğŸ“ ({{ item["Ø§Ù„Ø¯ÙˆÙ„Ø©"] }})
          <br>
          {% set flavors = item["Ø§Ù„Ø¥ÙŠØ­Ø§Ø¡Ø§Øª"] or "" %}
          {% for flavor in flavors.split("ØŒ") %}
            {% if flavor.strip() %}
              <span class="tag">{{ flavor.strip() }}</span>
            {% endif %}
          {% endfor %}
          <br>ğŸ’° {{ item["Ø§Ù„Ø³Ø¹Ø±"] }} Ø±ÙŠØ§Ù„
        </div>
      {% endfor %}
    {% elif request.method == 'POST' %}
      <div class="card">ğŸ˜• No results found for this budget/flavors. Try increasing the budget or changing keywords.</div>
    {% endif %}
  </div>

  <script>
    // Update displayed max price value when slider changes
    const maxSlider = document.getElementById('maxPrice');
    const maxValue = document.getElementById('maxPriceValue');

    maxSlider.addEventListener('input', function() {
      maxValue.textContent = this.value + " Ø±ÙŠØ§Ù„";
    });
  </script>
</body>
</html>
